\documentclass{ludis}

% xelatex
\usepackage{fontspec}
\usepackage{xunicode}
\usepackage{xltxtra}

% languages
\usepackage{fixlatvian}
\usepackage{polyglossia}
\setdefaultlanguage{latvian}
\setotherlanguages{english,russian}

% bibliography
\usepackage{csquotes}
\usepackage[
    backend=biber,
    style=numeric,
    natbib=true,
    url=false,
    doi=true%,
    %eprint=false
]{biblatex}
\addbibresource{bibliography.bib}

\usepackage[]{hyperref}
\hypersetup{
    colorlinks=false,
}

% toc
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

%tables
\usepackage{longtable}

%papildus matemātika
\usepackage{mathtools}

\fakultate{Datorikas}
\nosaukums{Ultrametriski automāti}
\darbaveids{Bakalaura}
\autors{Rihards Krišlauks}
\studapl{rk09006}
\vaditajs{Prof., Dr. habil. math. Rūsiņš Mārtiņš Freivalds}
\vieta{Rīga}
\gads{2013}

\begin{document}
\maketitle

\begin{abstract-lv}
TODO
\keywords{TODO}
\end{abstract-lv}
\clearpage

\begin{abstract-en}
TODO
\keywords{TODO}
\end{abstract-en}


\tableofcontents

\specnodala{Apzīmējumu saraksts}
\setlength\LTleft{0pt}
\setlength\LTright{0pt}
\begin{longtable}{| c | p{28em} |}
  \hline
  \textbf{Apzīmējums} & \textbf{Atšifrējums}\\ 
  \endhead

  \hline
  $U_pFA$ & Galīgs (vienvirziena) $p$-ultrametrisks automāts\\
  $1U_pFA(k)$ ($2U_pFA(k)$) &  Galīgs $k$-galviņu vienvirziena (divvirzienu) $p$-ultrametrisks automāts\\
  $1DFA(k)$ ($2DFA(k)$) &  Galīgs $k$-galviņu vienvirziena (divvirzienu) determinēts automāts\\
  $1NFA(k)$ ($2NFA(k)$) &  Galīgs $k$-galviņu vienvirziena (divvirzienu) nedeterminēts automāts\\
  $1PFA(k)$ ($2PFA(k)$) &  Galīgs $k$-galviņu vienvirziena (divvirzienu) varbūtisks automāts\\
  \hline
\end{longtable}

\specnodala{Ievads}
TODO

\chapter {Definīcijas}
\begin{definicija}
Katram nenulles racionālam skaitlim $\alpha$ eksistē viennozīmīgi nosakāms sadalījums pirmreizinātājos - $\alpha = \pm 2^{\alpha_2}3^{\alpha_3}5^{\alpha_5}7^{\alpha_7} \cdots$, kur $\alpha_i$-tie ir veseli skaitļi, no kuriem tikai galīgs skaits ir nenulles. Par racionāla skaitļa $\alpha$ \textbf{$p$-adisko absolūto vērtību} (arī sauktu par \textbf{$p$-normu}) sauc 
$||x||_p = \begin{cases}
p^{-\alpha_p}, \textrm{ja } \alpha \neq 0 \\
0, \textrm{ja } \alpha = 0
\end{cases} $
\end{definicija}


Ultrametriski automāti tiek definēti kā ~\citep{KasparsBalodis2013}.
\begin{definicija}
Galīgs $p$-ultrametrisks ($U_pFA$) automāts ir kortežs $\langle S, \Sigma, s_0, \delta, F, \Lambda \rangle$, kur
\begin{itemize}
  \item $S$ ir galīga stāvokļu kopa,
  \item $\Sigma$ ir galīga kopa, ($\$ \notin \Sigma$) -- ieejas alfabēts,
  \item $s_0:S \rightarrow \mathbb{Q}_p$ ir sākotnējais amplitūdu sadalījums,
  \item $\delta: \left( \Sigma \cup \left\{ \$ \right\} \right) \times S \times S \rightarrow \mathbb{Q}_p$ ir pārejas funkcija,
  \item $F \subseteq S$ ir akceptējošo stāvokļu kopa,
  \item $\Lambda = \left( \lambda, \diamond \right)$ ir akceptēšanas nosacījums, kur $\lambda \in \mathbb{R}$ ir akceptēšanas slieksnis, un $\diamond \in \left\{ \leq, \geq \right\}$.
\end{itemize}
Automāts darbojas šādi. %TODO "šādi" ir slikti
Katrā laika momentā katram automāta stāvoklim ir piekārtots $p$-adisks skaitlis, saukts par stāvokļa amplitūdu.
Automāts darbu sāk ar sākotnējo amplitūdu sadalījumu $s_0$.
Tas pa vienam pēc kārtas apstrādā ieejas vārda $w = w_1 \ldots w_n$ simbolus.
Amplitūdu sadalījums pēc $i$-tā simbola ielasīšanas tiek apzīmēts ar $s_i$, kur
$s_i(y) = \sum_{x \in S}{s_{i-1}(x) \cdot \delta \left( w_i, x, y \right) }$ katram $y \in S$.
Pēc $n$-tā simbola ielasīšanas tādā pat veidā tiek apstrādāts beigu marķieris $\$$, iegūstot beigu amplitūdu sadalījumu $s_{n+1}$.
Akceptēšanas nosacījums tiek piemērots akceptējošo stāvokļu beigu amplitūdu $p$-normu summai. Tas ir, ja $\sum_{x \in F}{\left| s_{n+1}(x) \right|_p} \diamond \lambda$, tad saka, ka vārds $w$ tiek akceptēts, citādi -- noraidīts.
\end{definicija}

Divvirzienu $k$-galviņu (kur $k\geq 1$) galīgs automāts sastāv no ieejas lentas, kas satur ieejas vārdu, pa kuru automāta galviņas drīkst pārvietoties abos virzienos, nepārkāpjot vārda galu atdalītājsimbolu  robežas. Simbolus uz ieejas lentas drīkst tikai lasīt. Formālāk:
\begin{definicija}[~\cite{Holzer2009}]
Par nedeterminētu divvirzienu $k$-galviņu galīgu automātu ($2NFA(k)$) tiek saukts kortežs $\langle S, \Sigma, k, s_0, \delta, F \rangle$, kur
\begin{itemize}
	\item $S$ ir galīga stāvokļu kopa,
	\item $\Sigma$ ir galīga kopa, ($ \triangleright,\triangleleft \notin \Sigma$) -- ieejas alfabēts,
	\item $k\geq 1$ ir galviņu skaits, 
	\item $s_0\in S$ ir sakuma stāvoklis,
	\item $\delta: \left( \Sigma \cup \left\{ \triangleright, \triangleleft \right\} \right)^k \times S \times S \rightarrow \left\{-1,0,1\right\}^k$ ir pārejas funkcija, kur $\triangleright$ un $\triangleleft$ ir vārda sākumu un beigas atdalošie simboli,
	\item $F \subseteq S$ ir akceptējošo stāvokļu kopa.
\end{itemize}
\end{definicija}
$2NFA(k)$ sākot darbu, visas tā galviņas ir novietotas uz vārda sakuma simbola. Automāts darbu beidz, kad pārejas funkcija dotajai automāta konfigurācijai nav definēta. Par $2NFA(k)$ konfigurāciju kādā laika momentā $t\geq 0$ sauc kortežu $c_t=\left(w,s,p\right)$, kur $w$ ir ieejas vārds, $s\in S$ ir pašreizējais stāvoklis, un
$p = \left( p_1, \ldots, p_k \right) \in \left\{ 0, \ldots, |w| +1 \right\}^k $
norāda pašreizējās galviņu pozīcijas. Pāreju no vienas konfigurācijas uz nākamo apzīmē ar $\vdash$. Pāreja
$\left( w, s, \left( p_1, \ldots, p_k \right) \right) \vdash \left( w, s', \left( p_1+d_1, \ldots, p_k+d_k \right) \right)$
notiek tad un tikai tad, ja
$\left(d_1, \ldots, d_k \right) \in \delta \left( \left( a_{p_1}, \ldots a_{p_k} \right) s, s' \right)$,
kur $w = a_1a_2 \ldots a_n$ ir ieejas vārds, un $a_0=\triangleright$, un $a_{n+1}=\triangleleft$. $\vdash$ refleksīvais, tranzitīvais slēgums tiek apzīmēts ar $\vdash^*$.

Valodā $L(M)$, ko akceptē automāts $M$ ietilpst tie un tikai tie vārdi, ko akceptē $M$. $2NFA(k)$ akceptē tos un tikai tos vārdus $w$, kam pastāv kāda konfigurāciju virkne, kas noved pie automāta apstāšanās akceptējoša stāvoklī, ja uz ieejas lentes ir
$\triangleright w \triangleleft$. Jeb precīzāk - $L(M)=\left\{ w \in \Sigma^* | \left(w,s_0,\left(1,\ldots,1\right)\right) \vdash^* \left(w,s,\left(p_1,\ldots,p_k\right)\right), s \in F, \textrm{un } M \textrm{apstājas } \left(w,s,\left(p_1,\ldots,p_k\right)\right)\right\}$. %TODO pabeigt par 2DFA(k).

Ultrametrisku vairākgalviņu definīcija tiek iegūta visdabiskākajā veidā paplašinot ~\citep{KasparsBalodis2013} ieviesto ultrametrisko automātu definīciju. Par pamatu tiek ņemta arī ~\citep{Holzer2009} ieviestā vairākgalviņu automātu definīcija.

\begin{definicija}
Par galīgu $k$-galviņu divvirzienu $p$-ultrametrisku automātu ($2U_pFA(k)$) tiek saukts kortežs $\langle S, \Sigma, k, s_0, \delta, F, \Lambda \rangle$, kur
\begin{itemize}
	\item $S$ ir galīga stāvokļu kopa,
	\item $\Sigma$ ir galīga kopa, ($ \triangleright,\triangleleft \notin \Sigma$) -- ieejas alfabēts,
	\item $k\geq 1$ ir galviņu skaits, 
	\item $s_0:S \rightarrow \mathbb{Q}_p$ ir sākotnējais amplitūdu sadalījums,
	\item $\delta: \left( \Sigma \cup \left\{ \triangleright, \triangleleft \right\} \right)^k \times S \times S \rightarrow \mathbb{Q}_p \times \left\{-1,0,1\right\}^k$ ir pārejas funkcija, kur $\triangleright$ un $\triangleleft$ ir vārda sākumu un beigas atdalošie simboli,
	\item $F \subseteq S$ ir akceptējošo stāvokļu kopa,
	\item $\Lambda = \left( \lambda, \diamond \right)$ ir akceptēšanas nosacījums, kur $\lambda \in \mathbb{R}$ ir akceptēšanas slieksnis, un $\diamond \in \left\{ \leq, \geq \right\}$.
\end{itemize}
\end{definicija}

$2U_pFA(k)$ darbojas līdzīgi, kā $U_pFA$, ar to izņēmumu, ka automātam tagad ir $k$ galviņas, un tās var kustēties abos virzienos līdzīgi kā $2NFA(k)$. Atšķirībā no $U_pFA$ tagad amplitūdas tiek norādītas stāvokļa un galviņu pozīcijas pārim. Amplitūda ar kādu automāts atrodas stāvoklī $y \in S$ ar galviņām pozīcijās
$\left( p_1, \ldots, p_k \right) \in \left\{ 0, \ldots, |w| +1 \right\}^k $
pēc $i$-tās darbības veikšanas tiek apzīmēta ar
$$
s_i (y, (p_1, \ldots, p_k)) =
\sum_{\mathclap{\substack{ x \in S \wedge \\
		\exists (p'_1, \ldots, p'_k):
		(p'_1, \ldots, p'_k) +
		\delta ((w_{p'_1}, \ldots, w_{p'_k}), x, y)_2 =
		(p_1, \ldots, p_k)}}}
	{s_{i-1}(x) \cdot \delta ((w_{p'_1}, \ldots, w_{p'_k}), x, y)_1 }
$$.

Līdzīgi kā iepriekš, automātam beidzot darbu, akceptēšanas nosacījums tiek piemērots akceptējošo stāvokļu beigu beigu amplitūdu $p$-normu summai. Tas ir, ja
$$\sum_{\mathclap{\substack{x \in F \wedge\\
		\exists (p_1, \ldots, p_k):
		\textrm{ automāts beidz darbu stāvoklī } x
		\textrm{ ar galviņām pozicijās } (p_1, \ldots, p_k) }}}
	{\left| s_{n+1}(x, (p_1, \ldots, p_k)) \right|_p} \diamond \lambda
$$, tad saka, ka vārds $w$ tiek akceptēts, citādi -- noraidīts.

%TODO sameklēt visas pareizrakstības kļūdas, piem., ari

Ultrametriskas Tjūringa mašīnas definīcija tiek iegūta dabiskā veida paplašinot J. Hopcroft un J. Ullman ~\citep{Hopcroft1979} 1979. gadā ieviesto definīciju.
\begin{definicija}
Par Tjūringa mašīnu sauc kortežu $M= \langle Q, \Gamma, b, \Sigma, \delta, q_0, F \rangle$, kur:
\begin{itemize}
	\item $Q$ ir galīga netukša stāvokļu kopa,
	\item $\Gamma$ ir galīga netukša kopa -- darba alfabēts,
	\item $b \in \Gamma$ ir "tukšais" simbols (drīkst atrasties uz lentes neierobežoti daudz eksemplāros),
	\item $\Sigma\subseteq\Gamma\setminus\{b\}$ ieejas alfabēts,
	\item $q_0 \in Q$ ir sākuma stāvoklis,
	\item $F \subseteq Q$ is the set of ''final'' or ''accepting states''.
	\item $\delta: Q \setminus F \times \Gamma \rightarrow Q \times \Gamma \times \{L,N,R\}$ ir daļēji definēta pārejas funkcija, kur $L$ apzīmē mašīnas galviņas pabīdīšanu pa kreisi , $R$ -- pabīdīšanu pa labi, un $N$ norāda, ka mašīnas galviņa netiek pārvietota.
\end{itemize}
\end{definicija}


\chapter {Rezultāti}
\section {Vairāk-galviņu automāti}
\begin{teorema}
Katram $k \geq 1 \in \mathbb{N}$ eksistē valoda $L_k$, tāda ka:\\ 
1) katram $k \geq 1 \in \mathbb{N}$ eksistē $1U_pFA(1)$, kas atpazīst $L_k$,\\ %TODO varbut arī var regulētu..
2) $L_k$ nevar atpazīt ne ar kādu $1DFA(k)$,\\
3) $L_k$ nevar atpazīt ne ar kādu $1NFA(k)$,\\
4) $L_k$ nevar atpazīt ne ar kādu $1PFA(1)$. 
\end{teorema}
\begin{pieradijums} Meklētā valoda ir
$$
L_k = \left\{ w_1 1 w_2 1 \ldots 1 w_{2n} |
		w_i \in \left\{ 0 \right\}^m \wedge
		m \geq 1 \in \mathbb{N} \wedge
		w_i = w_{2n-i+1} \wedge
		n={k\choose 2}+1 \right\}.
$$
Tālāk tiks pierādīts, ka $L_k$ apmierina teorēmas punktus.

$1)$ Tiks parādīts, kā patvaļīgai valodai $L_k$ uzbūvēt $1U_pFA(1)$ katram pirmskaitlim $p$. Automāts, sāk darbu ar amplitūdu $1$ $k$ dažādos sākuma stāvokļos $q_{1,1},q_{1,2},\ldots,q_{1,k}$. No katra no šiem stāvokļiem izies "zars", kas būs atbildīgs par amplitūdas krāšanu vienā no $k$ dažādiem akceptējošajiem stāvokļiem $q_{2k,1},q_{2k,2},\ldots,q_{2k,k}$.

Ielasot $0$, atrodoties kādā no sākuma stāvokļiem $q_{1,i}, 1 \leq i \leq k$, stāvokļa amplitūda tiek pareizināta ar $p$. Ielasot $1$ automāts ar amplitūdu $1$ pāriet no $q_{1,i}$ uz stāvokli $q_{2,i}$ (tādējādi tur pārnesot sakrāto amplitūdu). Tālāk stāvoklī $q_{2,i}$, ielasot $0$, amplitūda tiek pareizināta ar $p^{i\cdot 2}$, stāvoklī $q_{3,i}$ -- ar $p^{i\cdot 3}$ (katrā stāvoklī $q_{j,i}$ pārejot uz $q_{j+1,i}$ ar amplitūdu $1$, ja ielasīts $1$), u.t.t., līdz ir ielasīti $n$ simboli $1$. Šajā brīdī automāts sakrāto amplitūdu katrā zarā tādā pašā veidā sāk dalīt ar attiecīgajām $p$ pakāpēm tikai apgrieztā secība -- stāvoklī $q_{n+1,i}$ -- ar $p^{i\cdot n}$, stāvoklī $q_{n+2,i}$ -- ar $p^{i\cdot n-1}$, u.t.t. Jeb precīzāk -- stāvoklī $q_{j,i}$ ielasot $0$, stāvokļa amplitūda tiek pareizināta ar
$$
r = \begin{cases}
		p^{i\cdot j} &\mbox{ja } 1 \leq j \leq n; \\
		p^\frac{1}{i\cdot (2n-j+1)} & \mbox{ja } n \leq j \leq 2n. \end{cases}
$$
, un, ielasot $1$, ar amplitūdu $1$ tiek pāriets uz $q_{j+1,i}$.

Rezultātā, ja tika ielasīts vārds $0^{a_1}10^{a_2}10^{a_3}1\ldots 10^{a_{2n}}$, katrā no beigu stāvokļiem $q_{2n,i}$ ir sakrājusies amplitūda
$p^{a_1}\cdot p^{a_2 \cdot (2\cdot i)}\cdot p^{a_3 \cdot (3\cdot i)}\cdots p^{a_n \cdot (n\cdot i)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot i)}}\cdots \frac{1}{p^{a_{2n-2} \cdot (3\cdot i)}}\cdot \frac{1}{p^{a_{2n-1} \cdot (2\cdot i)}}\cdot \frac{1}{p^{a_{2n}}}$,
kas ir vienāda ar $1$, ja vārds pieder valodai; t.i., ja
$a_1 = a_{2n} \wedge a_2 = a_{2n-1} \wedge \ldots \wedge a_n = a_{n+1}$.
Iegūstam, ka vārds pieder valodai tad un tikai tad, ja ir apmierināta šāda vienādojumu sistēma:
$$
	\begin{cases}
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 1)} \cdots p^{a_n \cdot (n\cdot 1)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot 1)}}\cdots \frac{1}{p^{a_{2n-1} \cdot (2\cdot 1)}}\cdot \frac{1}{p^{a_{2n}}} = 1\\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 2)}\cdots p^{a_n \cdot (n\cdot 2)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot 2)}}\cdots \frac{1}{p^{a_{2n-1} \cdot (2\cdot 2)}}\cdot \frac{1}{p^{a_{2n}}} = 1\\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 3)}\cdots p^{a_n \cdot (n\cdot 3)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot 3)}}\cdots \frac{1}{p^{a_{2n-1} \cdot (2\cdot 3)}}\cdot \frac{1}{p^{a_{2n}}} = 1\\
		\cdots \\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot n)}\cdots p^{a_n \cdot (n\cdot n)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot n)}}\cdots \frac{1}{p^{a_{2n-1} \cdot (2\cdot n)}}\cdot \frac{1}{p^{a_{2n}}} = 1\\
	\end{cases}
$$,
pārrakstot
$$
	\begin{cases}
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 1)} \cdots p^{a_n \cdot (n\cdot 1)} = p^{a_{n+1} \cdot (n\cdot 1)}\cdots p^{a_{2n-1} \cdot (2\cdot 1)}\cdot p^{a_{2n}}\\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 2)} \cdots p^{a_n \cdot (n\cdot 2)} = p^{a_{n+1} \cdot (n\cdot 2)}\cdots p^{a_{2n-1} \cdot (2\cdot 2)}\cdot p^{a_{2n}}\\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 3)} \cdots p^{a_n \cdot (n\cdot 3)} = p^{a_{n+1} \cdot (n\cdot 3)}\cdots p^{a_{2n-1} \cdot (2\cdot 3)}\cdot p^{a_{2n}}\\
		\cdots \\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot n)} \cdots p^{a_n \cdot (n\cdot n)} = p^{a_{n+1} \cdot (n\cdot n)}\cdots p^{a_{2n-1} \cdot (2\cdot n)}\cdot p^{a_{2n}}\\
	\end{cases}
$$,
pārrakstot iegūstam
$$
	\begin{cases}
		(a_1 - a_{2n}) + (2\cdot 1) \cdot (a_2 - a_{2n-1}) + (3 \cdot 1)\cdot (a_3 - a_{2n-2}) + \cdots + (n \cdot 1) \cdot (a_n - a_{n+1}) = 0\\
		(a_1 - a_{2n}) + (2\cdot 2) \cdot (a_2 - a_{2n-1}) + (3 \cdot 2)\cdot (a_3 - a_{2n-2}) + \cdots + (n \cdot 2) \cdot (a_n - a_{n+1}) = 0\\
		(a_1 - a_{2n}) + (2\cdot 3) \cdot (a_2 - a_{2n-1}) + (3 \cdot 3)\cdot (a_3 - a_{2n-2}) + \cdots + (n \cdot 3) \cdot (a_n - a_{n+1}) = 0\\
		\cdots \\
		(a_1 - a_{2n}) + (2\cdot n) \cdot (a_2 - a_{2n-1}) + (3 \cdot n)\cdot (a_3 - a_{2n-2}) + \cdots + (n \cdot n) \cdot (a_n - a_{n+1}) = 0\\
	\end{cases}
$$

Apskatīsim šīs sistēmas determinantu. Izdalot $i$-to rindiņu ar $i$ katram $1 \leq i \leq n$, pirmajā kolonnā iegūstam koeficientus
$1, \frac{1}{2}, \frac{1}{3}, \ldots, \frac{1}{n}$,
tātad matricā nav divu lineāri atkarīgu rindiņu, un matricas determinants ir atšķirīgs no nulles. Tā kā dotā vienādojumu sistēma ir homogēna, tai eksistē tikai triviālais atrisinājums.

$2)$ TODO

$3)$ TODO

$4)$ TODO
\end{pieradijums}

\printbibliography

\end{document}