\documentclass{ludis}

% xelatex
\usepackage{fontspec}
\usepackage{xunicode}
\usepackage{xltxtra}

% languages
\usepackage{fixlatvian}
\usepackage{polyglossia}
\setdefaultlanguage{latvian}
\setotherlanguages{english,russian}

% bibliography
\usepackage{csquotes}
\usepackage[
    backend=biber,
    style=numeric,
    natbib=true,
    url=false,
    doi=true%,
    %eprint=false
]{biblatex}
\addbibresource{bibliography.bib}

\usepackage[]{hyperref}
\hypersetup{
    colorlinks=false,
}

% toc
\setcounter{secnumdepth}{3}
\setcounter{tocdepth}{3}

%tables
\usepackage{longtable}

%papildus matemātika
\usepackage{mathtools}
\allowdisplaybreaks

%dalīšana kolonnās
\usepackage{multicol}

\fakultate{Datorikas}
\nosaukums{Ultrametriski automāti}
\darbaveids{Bakalaura}
\autors{Rihards Krišlauks}
\studapl{rk09006}
\vaditajs{Prof., Dr. habil. math. Rūsiņš Mārtiņš Freivalds}
\vieta{Rīga}
\gads{2013}

\begin{document}
\maketitle

\begin{abstract-lv}
TODO
\keywords{TODO}
\end{abstract-lv}
\clearpage

\begin{abstract-en}
TODO
\keywords{TODO}
\end{abstract-en}


\tableofcontents

\specnodala{Apzīmējumu saraksts}
\setlength\LTleft{0pt}
\setlength\LTright{0pt}
\begin{longtable}{| c | p{28em} |}
  \hline
  \textbf{Apzīmējums} & \textbf{Atšifrējums}\\ 
  \endhead

  \hline
  $u_pfa$ & Galīgs (vienvirziena) $p$-ultrametrisks automāts\\
  $1u_pfa(k)$ ($2u_pfa(k)$) &  Galīgs $k$-galviņu vienvirziena (divvirzienu) $p$-ultrametrisks automāts\\
  $1U_PFA(k)$ ($2U_PFA(k)$) &  Valodu klase, ko var atpazīt ar galīgs $k$-galviņu vienvirziena (divvirzienu) $p$-ultrametrisku automātu\\
  $1dfa(k)$ ($2dfa(k)$) &  Galīgs $k$-galviņu vienvirziena (divvirzienu) determinēts automāts\\
  $1nfa(k)$ ($2nfa(k)$) &  Galīgs $k$-galviņu vienvirziena (divvirzienu) nedeterminēts automāts\\
  $1pfa(k)$ ($2pfa(k)$) &  Galīgs $k$-galviņu vienvirziena (divvirzienu) varbūtisks automāts\\
  $u_ptm$ &  $p$-ultrametriska Tjūringa mašīna\\
  $U_pTM$ &  Valodu klase, ko var atpazīt ar $p$-ultrametrisku Tjūringa mašīnu\\
  $\widehat{C}$ & Valodu klases $C$ apakškopa, kas satur tikai valodas formā $1^{2^n}, n \in \mathbb{N}$, jeb precīzāk -- $\widehat{C} = \left\{ h | h \in C \wedge \exists n \in \mathbb{N} : h = 1^{2^n} \right\}$\\
  \hline
\end{longtable}

\specnodala{Ievads}
TODO

\chapter {Definīcijas}
\begin{definicija}
Katram nenulles racionālam skaitlim $\alpha$ eksistē viennozīmīgi nosakāms sadalījums pirmreizinātājos - $\alpha = \pm 2^{\alpha_2}3^{\alpha_3}5^{\alpha_5}7^{\alpha_7} \cdots$, kur $\alpha_i$-tie ir veseli skaitļi, no kuriem tikai galīgs skaits ir nenulles. Par racionāla skaitļa $\alpha$ \textbf{$p$-adisko absolūto vērtību} (arī sauktu par \textbf{$p$-normu}) sauc 
$||x||_p = \begin{cases}
p^{-\alpha_p}, \textrm{ja } \alpha \neq 0 \\
0, \textrm{ja } \alpha = 0
\end{cases} $
\end{definicija}


Ultrametriski automāti tiek definēti kā ~\citep{KasparsBalodis2013}.
\begin{definicija}
Galīgs $p$-ultrametrisks ($U_pFA$) automāts ir kortežs $\langle S, \Sigma, s_0, \delta, F, \Lambda \rangle$, kur
\begin{itemize}
  \item $S$ ir galīga stāvokļu kopa,
  \item $\Sigma$ ir galīga kopa, ($\$ \notin \Sigma$) -- ieejas alfabēts,
  \item $s_0:S \rightarrow \mathbb{Q}_p$ ir sākotnējais amplitūdu sadalījums, %TODO vai tiešam pareizi?
  \item $\delta: \left( \Sigma \cup \left\{ \$ \right\} \right) \times S \times S \rightarrow \mathbb{Q}_p$ ir pārejas funkcija,
  \item $F \subseteq S$ ir akceptējošo stāvokļu kopa,
  \item $\Lambda = \left( \lambda, \diamond \right)$ ir akceptēšanas nosacījums, kur $\lambda \in \mathbb{R}$ ir akceptēšanas slieksnis, un $\diamond \in \left\{ \leq, \geq \right\}$.
\end{itemize}
Automāts darbojas šādi. %TODO "šādi" ir slikti
Katrā laika momentā katram automāta stāvoklim ir piekārtots $p$-adisks skaitlis, saukts par stāvokļa amplitūdu.
Automāts darbu sāk ar sākotnējo amplitūdu sadalījumu $s_0$.
Tas pa vienam pēc kārtas apstrādā ieejas vārda $w = w_1 \ldots w_n$ simbolus.
Amplitūdu sadalījums pēc $i$-tā simbola ielasīšanas tiek apzīmēts ar $s_i$, kur
$s_i(y) = \sum_{x \in S}{s_{i-1}(x) \cdot \delta \left( w_i, x, y \right) }$ katram $y \in S$.
Pēc $n$-tā simbola ielasīšanas tādā pat veidā tiek apstrādāts beigu marķieris $\$$, iegūstot beigu amplitūdu sadalījumu $s_{n+1}$.
Akceptēšanas nosacījums tiek piemērots akceptējošo stāvokļu beigu amplitūdu $p$-normu summai. Tas ir, ja $\sum_{x \in F}{\left| s_{n+1}(x) \right|_p} \diamond \lambda$, tad saka, ka vārds $w$ tiek akceptēts, citādi -- noraidīts.
\end{definicija}

Divvirzienu $k$-galviņu (kur $k\geq 1$) galīgs automāts sastāv no ieejas lentas, kas satur ieejas vārdu, pa kuru automāta galviņas drīkst pārvietoties abos virzienos, nepārkāpjot vārda galu atdalītājsimbolu  robežas. Simbolus uz ieejas lentas drīkst tikai lasīt. Formālāk:
\begin{definicija}[~\cite{Holzer2009}]
Par nedeterminētu divvirzienu $k$-galviņu galīgu automātu ($2NFA(k)$) tiek saukts kortežs $\langle S, \Sigma, k, s_0, \delta, F \rangle$, kur
\begin{itemize}
	\item $S$ ir galīga stāvokļu kopa,
	\item $\Sigma$ ir galīga kopa, ($ \triangleright,\triangleleft \notin \Sigma$) -- ieejas alfabēts,
	\item $k\geq 1$ ir galviņu skaits, 
	\item $s_0\in S$ ir sakuma stāvoklis,
	\item $\delta: \left( \Sigma \cup \left\{ \triangleright, \triangleleft \right\} \right)^k \times S \times S \rightarrow \left\{-1,0,1\right\}^k$ ir pārejas funkcija, kur $\triangleright$ un $\triangleleft$ ir vārda sākumu un beigas atdalošie simboli,
	\item $F \subseteq S$ ir akceptējošo stāvokļu kopa.
\end{itemize}
\end{definicija}
$2NFA(k)$ sākot darbu, visas tā galviņas ir novietotas uz vārda sakuma simbola. Automāts darbu beidz, kad pārejas funkcija dotajai automāta konfigurācijai nav definēta. Par $2NFA(k)$ konfigurāciju kādā laika momentā $t\geq 0$ sauc kortežu $c_t=\left(w,s,p\right)$, kur $w$ ir ieejas vārds, $s\in S$ ir pašreizējais stāvoklis, un
$p = \left( p_1, \ldots, p_k \right) \in \left\{ 0, \ldots, |w| +1 \right\}^k $
norāda pašreizējās galviņu pozīcijas. Pāreju no vienas konfigurācijas uz nākamo apzīmē ar $\vdash$. Pāreja
$\left( w, s, \left( p_1, \ldots, p_k \right) \right) \vdash \left( w, s', \left( p_1+d_1, \ldots, p_k+d_k \right) \right)$
notiek tad un tikai tad, ja
$\left(d_1, \ldots, d_k \right) \in \delta \left( \left( a_{p_1}, \ldots a_{p_k} \right) s, s' \right)$,
kur $w = a_1a_2 \ldots a_n$ ir ieejas vārds, un $a_0=\triangleright$, un $a_{n+1}=\triangleleft$. $\vdash$ refleksīvais, tranzitīvais slēgums tiek apzīmēts ar $\vdash^*$.

Valodā $L(M)$, ko akceptē automāts $M$ ietilpst tie un tikai tie vārdi, ko akceptē $M$. $2NFA(k)$ akceptē tos un tikai tos vārdus $w$, kam pastāv kāda konfigurāciju virkne, kas noved pie automāta apstāšanās akceptējoša stāvoklī, ja uz ieejas lentes ir
$\triangleright w \triangleleft$. Jeb precīzāk - $L(M)=\left\{ w \in \Sigma^* | \left(w,s_0,\left(1,\ldots,1\right)\right) \vdash^* \left(w,s,\left(p_1,\ldots,p_k\right)\right), s \in F, \textrm{un } M \textrm{apstājas } \left(w,s,\left(p_1,\ldots,p_k\right)\right)\right\}$. %TODO pabeigt par 2DFA(k).

Ultrametrisku vairākgalviņu definīcija tiek iegūta visdabiskākajā veidā paplašinot ~\citep{KasparsBalodis2013} ieviesto ultrametrisko automātu definīciju. Par pamatu tiek ņemta arī ~\citep{Holzer2009} ieviestā vairākgalviņu automātu definīcija.

\begin{definicija}
Par galīgu $k$-galviņu divvirzienu $p$-ultrametrisku automātu ($2U_pFA(k)$) tiek saukts kortežs $\langle S, \Sigma, k, s_0, \delta, F, \Lambda \rangle$, kur
\begin{itemize}
	\item $S$ ir galīga stāvokļu kopa,
	\item $\Sigma$ ir galīga kopa, ($ \triangleright,\triangleleft \notin \Sigma$) -- ieejas alfabēts,
	\item $k\geq 1$ ir galviņu skaits, 
	\item $s_0:S \rightarrow \mathbb{Q}_p$ ir sākotnējais amplitūdu sadalījums,
	\item $\delta: \left( \Sigma \cup \left\{ \triangleright, \triangleleft \right\} \right)^k \times S \times S \rightarrow \mathbb{Q}_p \times \left\{-1,0,1\right\}^k$ ir pārejas funkcija, kur $\triangleright$ un $\triangleleft$ ir vārda sākumu un beigas atdalošie simboli,
	\item $F \subseteq S$ ir akceptējošo stāvokļu kopa,
	\item $\Lambda = \left( \lambda, \diamond \right)$ ir akceptēšanas nosacījums, kur $\lambda \in \mathbb{R}$ ir akceptēšanas slieksnis, un $\diamond \in \left\{ \leq, \geq \right\}$.
\end{itemize}
\end{definicija}

$2U_pFA(k)$ darbojas līdzīgi, kā $U_pFA$, ar to izņēmumu, ka automātam tagad ir $k$ galviņas, un tās var kustēties abos virzienos līdzīgi kā $2NFA(k)$. Atšķirībā no $U_pFA$ tagad amplitūdas tiek norādītas stāvokļa un galviņu pozīcijas pārim. Amplitūda ar kādu automāts atrodas stāvoklī $y \in S$ ar galviņām pozīcijās
$\left( p_1, \ldots, p_k \right) \in \left\{ 0, \ldots, |w| +1 \right\}^k $
pēc $i$-tās darbības veikšanas tiek apzīmēta ar
\[
s_i (y, (p_1, \ldots, p_k)) =
\sum_{\mathclap{\substack{ x \in S \wedge \\
		\exists (p'_1, \ldots, p'_k):
		(p'_1, \ldots, p'_k) +
		\delta ((w_{p'_1}, \ldots, w_{p'_k}), x, y)_2 =
		(p_1, \ldots, p_k)}}}
	{s_{i-1}(x) \cdot \delta ((w_{p'_1}, \ldots, w_{p'_k}), x, y)_1 }
\].

Līdzīgi kā iepriekš, automātam beidzot darbu, akceptēšanas nosacījums tiek piemērots akceptējošo stāvokļu beigu beigu amplitūdu $p$-normu summai. Tas ir, ja
\[
\sum_{\mathclap{\substack{x \in F \wedge\\
		\exists (p_1, \ldots, p_k):
		\textrm{ automāts beidz darbu stāvoklī } x
		\textrm{ ar galviņām pozicijās } (p_1, \ldots, p_k) }}}
	{\left| s_{n+1}(x, (p_1, \ldots, p_k)) \right|_p} \diamond \lambda
\]
, tad saka, ka vārds $w$ tiek akceptēts, citādi -- noraidīts.

%TODO sameklēt visas pareizrakstības kļūdas, piem., ari

Ultrametriskas Tjūringa mašīnas definīcija tiek iegūta dabiskā veida paplašinot J. Hopcroft un J. Ullman ~\citep{Hopcroft1979} 1979. gadā ieviesto definīciju. Ērtības labad definēsim mašīnu ar vairākām darba lentēm.
\begin{definicija}
Par $p$-ultrametrisku Tjūringa mašīnu ar $k$ darba lentēm $(U_pTM(k))$ sauc kortežu $M= \langle Q, \Gamma, b, \Sigma, \delta, q_0, F \rangle$, kur:
\begin{itemize}
	\item $Q$ ir galīga netukša stāvokļu kopa,
	\item $\Gamma$ ir galīga netukša kopa -- darba alfabēts,
	\item $b \in \Gamma$ ir "tukšais" simbols (drīkst atrasties uz lentes neierobežoti daudz eksemplāros),
	\item $\Sigma\subseteq\Gamma\setminus\{b\}$ ieejas alfabēts,
	\item $q_0 \in Q$ ir sākuma stāvoklis,
	\item $F \subseteq Q$ ir akceptējošo stāvokļu kopa.
	\item $\delta: Q \setminus F \times \Gamma^k \rightarrow Q \times \left(\Gamma \times \{L,N,R\} \times \mathbb{Q}_p \right)^k$ ir daļēji definēta pārejas funkcija, kur $L$ apzīmē mašīnas galviņas pabīdīšanu pa kreisi , $R$ -- pabīdīšanu pa labi, un $N$ norāda, ka mašīnas galviņa netiek pārvietota, un $\mathbb{Q}_p$ ir amplitūda, ar kādu tiek veikta pāreja.
\end{itemize}
\end{definicija}

Līdzīgi kā ultrametrisku vairākgalviņu automātu gadījumā mašīna ar noteiktu amplitūdu atrodas kāda no tās iespējamajām konfigurācijām, bet tagad konfigurācija iekļauj vadības bloka stāvokli un visu $k$ lenšu saturu.
%TODO kā aprēķina amplitūdas


\chapter {Rezultāti}
\section {Vairākgalviņu automāti}
\subsection{Ultrametriska automāta simulācija}
Nākamās nodaļas pierādījumos tiks izmantota iespēja ultrametrisku vairākgalviņu automātu simulēt ar ultrametrisku Tjūringa mašīnu. Šeit tiks parādīti vispārīgie principi, kas ir šādas simulācijas pamatā, izmantotās idejas ir līdzīgas kā ~\citep{Macarie1995} varbūtisko automātu gadījumā.

Vienkāršības labad var pieņemt, ka simulējamajam automātam no katra stāvokļa iziet ne vairāk kā $2$ pārejas. Tiks aprakstīts veids, kā veidot $p$-ultrametrisku $2$ lenšu Tjūringa mašīnu, kas, ieejā saņemot $p$-ultrametriska $k$ galviņu automāta aprakstu, akceptē tos un tikai tos vārdus, ko simulējamais automāts. Tā kā turpmākajā darbā šādas simulācijas nepieciešamība tiks apskatīta tikai darbojoties ar vārdiem viena burta alfabētā, tad tiks parādīts veids, kā automāta aprakstu uzdot izmantojot viena burta alfabētu; konkrētāk -- vārdus formā $1^{2^n}, n \in \mathbb{N}$. Vēl tiek prasīts, lai simulējamā automāta amplitūdas būtu $log-space$ $p$-konstruējamas skaitļu kopas. Par $log-space$ $p$-konstruējamu skaitļu kopu sauksim tādu kopu, kam eksistē $p$-ultrametriska Tjūringa mašīna ar $log-space$ telpas sarežģītību, kas, saņemot ieejā kaut kādu skaitļa, kas pieder kopai, "aprakstu", spēj nonākt kādā īpaši atzīmētā stāvoklī ar amplitūdu kas atbilst "aprakstam". Zemāk tiks parādīts, ka šāda ultrametriska Tjūringa mašīna pastāv amplitūdām racionālos skaitļos binārajā pierakstā.
%TODO pateikt, kāpēc vajag log space telpas sarežģītību

$p$-Ultrametriska galīga $k$ galviņu automāta aprakstu var uzdot ar bināru virkni, pēc kārtas norādot:
\begin{itemize}
	\item automāta stāvokļu skaitu,
	\item galviņu skaitu,
	\item pārejas starp stāvokļiem un to amplitūdas %TODO cik daudz vietas aizņem?
\end{itemize}

Simulācija tiek realizēta šādi. $p$-Ultrametriska galīga $k$ galviņu automāta ar pāreju amplitūdām no $log-space$ $p$-konstruējamas kopas, saukta par $A$, simulēšanai tiek veidota $p$-ultrametriska $2$ lenšu Tjūringa mašīna, saukta par $T$. $T$ uz ieejas lentes tiek padots $A$ apraksts viena burta alfabētā formā $1^{2^n}, n \in \mathbb{N}$. Sākot darbu $T$ ielasa ieejas vārdu un determinēti, pārejas veicot ar amplitūdu $1$, sagatavo 2. lentu, tur ierakstot skaitli $n$ binārā pierakstā. $n$ ir simulējamā automāta $A$ apraksts. Tiek arī izdalīta vieta apjomā $k \cdot n$ $k$ skaitītājiem, kas norādīs $A$ galviņu pozīcijas. Tālākajā simulācijas gaitā tiks izmantota tikai 2. lente (lai arī rakstīšanai var izmantot abas lentes, ērtībai sauksim 2. lenti par darba lenti).

Atceramies, ka $A$ savas darbības laikā iziet cauri vairāku konfigurāciju virknei, un katrā laika momentā $A$ var "paralēli" būt vairākās konfigurācijās ar dažādām amplitūdām. %TODO pateikt šo pie definīcijas
Ja $A$ atrodas kāda konfigurācijā ar amplitūdu $a$, tad $T$ to simulēs, ar atbilstošo amplitūdu atrodoties konfigurācijā, kur darba lentes saturs atbilst attiecīgajai $A$ konfigurācijai.

Lai parādītu, ka $T$ var šādā veidā simulēt $A$, jāparāda, ka $T$ ir spējīgs veikt katru $A$ pāreju. Parādīsim, ka, ja $A$ ir pāreja no $q_1$ uz $q_2$ ar amplitūdu $a_1$ (pieņemsim, ka tā ir apzīmēta ar numuru $i$ ) un pāreja no $q_1$ uz $q_3$ ar amplitūdu $a_2$ (pieņemsim, ka tā ir apzīmēta ar numuru $j$), tad $T$ atrodoties $q_1$ atbilstošajā konfigurācijā var "paralēli" veikt pārejas uz $q_2$ un $q_3$ atbilstošajām konfigurācijām ar attiecīgajām amplitūdām. Tas tiek darīts, $U$ sazarojoties un abos gadījumos ar amplitūdu $1$ īpašā vietā uz lentes ierakstot vai nu skaitli $i$ vai $j$, kas attiecīgi atbilst pirmajai un otrajai $A$ pārejai. Ierakstīšana tiek veikta determinēti, pārejas veicot ar amplitūdu $1$. Tālāk tiek darbināta apakšprogramma, kas ierakstītajam skaitlim atbilstošo amplitūdu $a_1$ vai $a_2$ ielasa īpašā stāvoklī $q_u$ (tā kā tika uzstādīta prasība, ka ir no $log-space$ $p$-konstruējamas kopas, tad šāda apakšprogramma eksistē). Tālāk no stāvokļa $q_u$ tiek pāriets uz bloku, kas darba lenti izmaina atbilstoši pārejai, kas atbilst uz lentas ierakstītajam skaitlim (tas tiek darīts determinēti, pārejas veicot ar amplitūdu $1$). Tā kā vienīgā pāreja, kas ir atšķirīga no $1$ tiek veikta pārejot no $q_u$, tad darbības beigās uz $U$ darba lentes ar amplitūdu $1 \cdot 1 \cdots 1 \cdot a_1 = a_1$ ir ieraksts, kas atbilst $A$ konfigurācijai pēc pārejas $i$ izdarīšanas, un ar amplitūdu $1 \cdot 1 \cdots 1 \cdot a_2 = a_2$ -- ieraksts, kas atbilst $A$ konfigurācijai pēc pārejas $j$ izdarīšanas.

%TODO zimējums

\begin{teorema}
Racionālie skaitļi veido $log-space$ $p$-konstruējamu kopu.
\end{teorema}
\begin{pieradijums}
Parādīsim, ka jebkuram pirmskaitlim $p$ eksistē $p$-ultrametriska vienas lentes Tjūringa mašīna, kas ieejā saņemot racionāla skaitļa $a$ pierakstu binārā formā, savas darbības beigās nonāk īpašā stāvoklī $q_u$ ar amplitūdu $a$.

Skaitlis $a$ uz lentes tiks padots formā $\triangleright a_n a_{n-1} \cdots a_1 \cdot a_0 | a_{-1} a_{-2} \cdots a_{-m} \triangleleft$, kur $\sum\limits_{i=-m}^n a_i \cdot 2^i = a$ ($|$ ir atdalītājsimbols). Mašīna sākotnēji, ignorējot atdalītājsimbolu, cikliski no skaitļa $a \cdot 2^m$ atņem $1$, katru reizi to izdarot, palielinot $q_u$ amplitūdu par $1$. Kad uz lentas atrodas vairs tikai $00 \cdots 0|00 \cdots 0$, mašīna $q_u$ sakrāto amplitūdu izdala ar $2^m$. $\rightarrow_i$ norāda, ka pāreja tiek veikta ar amplitūdu $i$.

Tjūringa mašīnas programmas teksts.
\begin{multicols}{2}
	\begin{align*}
	\shortintertext{Atņem $1$ no $a$}
		q_0\triangleleft & \rightarrow_1 q_1\triangleleft L\\
		q_10 & \rightarrow_1 q_11L\\
		q_11 & \rightarrow_1 q_20R\\
		q_1| & \rightarrow_1 q_1|L\\
	\shortintertext{Iet atpakaļ uz $a$ sākumu}
		q_20 & \rightarrow_1 q_20R\\
		q_21 & \rightarrow_1 q_21R\\
		q_2| & \rightarrow_1 q_2|R\\
		q_2\triangleleft & \rightarrow_1 q_1\triangleleft L\\
	\shortintertext{Palielina īpaša stavokļa apmlitūdu par $1$}
		q_2\triangleleft & \rightarrow_1 q_u'\triangleleft L\\
	\shortintertext{Atrodas $a$ sakumā, jo tas jau ir $0$}
		q_1\triangleright & \rightarrow_1 q_3\triangleright R\\
	\shortintertext{Nodzēš pēdejā gajienā kļūdaini sarakstīto}
		q_30 & \rightarrow_1 q_30R\\
		q_31 & \rightarrow_1 q_31R\\
		q_3| & \rightarrow_1 q_3|R\\
	\shortintertext{Dala īpašā stāvokļa amplitūdu, atbilstoši ciparu skaitam aiz komata}
		q_3\triangleleft & \rightarrow_1 q_u'\triangleleft L\\
		q_u'0 & \rightarrow_\frac{1}{2} q_u'0L\\
		q_u'1 & \rightarrow_\frac{1}{2} q_u'1L\\
	\shortintertext{Iet uz $a$ sākumu}
		q_u'| & \rightarrow_1 q_u|R\\
		q_u0 & \rightarrow_1 q_u0R\\
		q_u1 & \rightarrow_1 q_u1R\\
	\end{align*}
\end{multicols}
\end{pieradijums}


\subsection{Vienvirziena ultrametriski vairākgalviņu automāti}
\begin{teorema}
Katram $k \geq 1 \in \mathbb{N}$ eksistē valoda $L_k$, tāda ka:\\ 
1) katram $k \geq 1 \in \mathbb{N}$ eksistē $1U_pFA(1)$, kas atpazīst $L_k$,\\ %TODO varbut arī var regulētu..
2) $L_k$ nevar atpazīt ne ar kādu $1DFA(k)$,\\
3) $L_k$ nevar atpazīt ne ar kādu $1NFA(k)$,\\
4) $L_k$ nevar atpazīt ne ar kādu $1PFA(1)$.
\end{teorema}
\begin{pieradijums} Meklētā valoda ir
\[
L_k = \left\{ w_1 1 w_2 1 \ldots 1 w_{2n} |
		w_i \in \left\{ 0 \right\}^m \wedge
		m \geq 1 \in \mathbb{N} \wedge
		w_i = w_{2n-i+1} \wedge
		n={k\choose 2}+1 \right\}.
\]
Tālāk tiks pierādīts, ka $L_k$ apmierina teorēmas punktus.

$1)$ Tiks parādīts, kā patvaļīgai valodai $L_k$ uzbūvēt $1U_pFA(1)$ katram pirmskaitlim $p$. Automāts, sāk darbu ar amplitūdu $1$ $k$ dažādos sākuma stāvokļos $q_{1,1},q_{1,2},\ldots,q_{1,k}$. No katra no šiem stāvokļiem izies "zars", kas būs atbildīgs par amplitūdas krāšanu vienā no $k$ dažādiem akceptējošajiem stāvokļiem $q_{2k,1},q_{2k,2},\ldots,q_{2k,k}$.

Ielasot $0$, atrodoties kādā no sākuma stāvokļiem $q_{1,i}, 1 \leq i \leq k$, stāvokļa amplitūda tiek pareizināta ar $p$. Ielasot $1$ automāts ar amplitūdu $1$ pāriet no $q_{1,i}$ uz stāvokli $q_{2,i}$ (tādējādi tur pārnesot sakrāto amplitūdu). Tālāk stāvoklī $q_{2,i}$, ielasot $0$, amplitūda tiek pareizināta ar $p^{i\cdot 2}$, stāvoklī $q_{3,i}$ -- ar $p^{i\cdot 3}$ (katrā stāvoklī $q_{j,i}$ pārejot uz $q_{j+1,i}$ ar amplitūdu $1$, ja ielasīts $1$), u.t.t., līdz ir ielasīti $n$ simboli $1$. Šajā brīdī automāts sakrāto amplitūdu katrā zarā tādā pašā veidā sāk dalīt ar attiecīgajām $p$ pakāpēm tikai apgrieztā secība -- stāvoklī $q_{n+1,i}$ -- ar $p^{i\cdot n}$, stāvoklī $q_{n+2,i}$ -- ar $p^{i\cdot n-1}$, u.t.t. Jeb precīzāk -- stāvoklī $q_{j,i}$ ielasot $0$, stāvokļa amplitūda tiek pareizināta ar
\[
r = \begin{cases}
		p^{i\cdot j} &\mbox{ja } 1 \leq j \leq n; \\
		p^\frac{1}{i\cdot (2n-j+1)} & \mbox{ja } n \leq j \leq 2n. \end{cases}
\]
, un, ielasot $1$, ar amplitūdu $1$ tiek pāriets uz $q_{j+1,i}$.

Rezultātā, ja tika ielasīts vārds $0^{a_1}10^{a_2}10^{a_3}1\ldots 10^{a_{2n}}$, katrā no beigu stāvokļiem $q_{2n,i}$ ir sakrājusies amplitūda
$p^{a_1}\cdot p^{a_2 \cdot (2\cdot i)}\cdot p^{a_3 \cdot (3\cdot i)}\cdots p^{a_n \cdot (n\cdot i)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot i)}}\cdots \frac{1}{p^{a_{2n-2} \cdot (3\cdot i)}}\cdot \frac{1}{p^{a_{2n-1} \cdot (2\cdot i)}}\cdot \frac{1}{p^{a_{2n}}}$,
kas ir vienāda ar $1$, ja vārds pieder valodai; t.i., ja
$a_1 = a_{2n} \wedge a_2 = a_{2n-1} \wedge \ldots \wedge a_n = a_{n+1}$.
Iegūstam, ka vārds pieder valodai tad un tikai tad, ja ir apmierināta šāda vienādojumu sistēma:
\begin{gather*}
	\begin{cases}
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 1)} \cdots p^{a_n \cdot (n\cdot 1)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot 1)}}\cdots \frac{1}{p^{a_{2n-1} \cdot (2\cdot 1)}}\cdot \frac{1}{p^{a_{2n}}} = 1\\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 2)}\cdots p^{a_n \cdot (n\cdot 2)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot 2)}}\cdots \frac{1}{p^{a_{2n-1} \cdot (2\cdot 2)}}\cdot \frac{1}{p^{a_{2n}}} = 1\\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 3)}\cdots p^{a_n \cdot (n\cdot 3)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot 3)}}\cdots \frac{1}{p^{a_{2n-1} \cdot (2\cdot 3)}}\cdot \frac{1}{p^{a_{2n}}} = 1\\
		\cdots \\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot n)}\cdots p^{a_n \cdot (n\cdot n)} \cdot \frac{1}{p^{a_{n+1} \cdot (n\cdot n)}}\cdots \frac{1}{p^{a_{2n-1} \cdot (2\cdot n)}}\cdot \frac{1}{p^{a_{2n}}} = 1\\
	\end{cases}\\
\intertext{pārrakstot}
	\begin{cases}
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 1)} \cdots p^{a_n \cdot (n\cdot 1)} = p^{a_{n+1} \cdot (n\cdot 1)}\cdots p^{a_{2n-1} \cdot (2\cdot 1)}\cdot p^{a_{2n}}\\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 2)} \cdots p^{a_n \cdot (n\cdot 2)} = p^{a_{n+1} \cdot (n\cdot 2)}\cdots p^{a_{2n-1} \cdot (2\cdot 2)}\cdot p^{a_{2n}}\\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot 3)} \cdots p^{a_n \cdot (n\cdot 3)} = p^{a_{n+1} \cdot (n\cdot 3)}\cdots p^{a_{2n-1} \cdot (2\cdot 3)}\cdot p^{a_{2n}}\\
		\cdots \\
		p^{a_1}\cdot p^{a_2 \cdot (2\cdot n)} \cdots p^{a_n \cdot (n\cdot n)} = p^{a_{n+1} \cdot (n\cdot n)}\cdots p^{a_{2n-1} \cdot (2\cdot n)}\cdot p^{a_{2n}}\\
	\end{cases}\\
\intertext{pārrakstot iegūstam}
	\begin{cases}
		(a_1 - a_{2n}) + (2\cdot 1) \cdot (a_2 - a_{2n-1}) + (3 \cdot 1)\cdot (a_3 - a_{2n-2}) + \cdots + (n \cdot 1) \cdot (a_n - a_{n+1}) = 0\\
		(a_1 - a_{2n}) + (2\cdot 2) \cdot (a_2 - a_{2n-1}) + (3 \cdot 2)\cdot (a_3 - a_{2n-2}) + \cdots + (n \cdot 2) \cdot (a_n - a_{n+1}) = 0\\
		(a_1 - a_{2n}) + (2\cdot 3) \cdot (a_2 - a_{2n-1}) + (3 \cdot 3)\cdot (a_3 - a_{2n-2}) + \cdots + (n \cdot 3) \cdot (a_n - a_{n+1}) = 0\\
		\cdots \\
		(a_1 - a_{2n}) + (2\cdot n) \cdot (a_2 - a_{2n-1}) + (3 \cdot n)\cdot (a_3 - a_{2n-2}) + \cdots + (n \cdot n) \cdot (a_n - a_{n+1}) = 0\\
	\end{cases}
\end{gather*}

Apskatīsim šīs sistēmas determinantu. Izdalot $i$-to rindiņu ar $i$ katram $1 \leq i \leq n$, pirmajā kolonnā iegūstam koeficientus
$1, \frac{1}{2}, \frac{1}{3}, \ldots, \frac{1}{n}$,
tātad matricā nav divu lineāri atkarīgu rindiņu, un matricas determinants ir atšķirīgs no nulles. Tā kā dotā vienādojumu sistēma ir homogēna, tai eksistē tikai triviālais atrisinājums.
%TODO nav taisnība. vajag Vandermonda variantu

$2)$ TODO

$3)$ TODO

$4)$ TODO
\end{pieradijums}

\begin{lemma}
Katram naturālam skaitlim $k$
\end{lemma}

\printbibliography

\end{document}